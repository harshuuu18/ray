(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{1162:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return f}});var t=r(5861),i=r(7757),s=r.n(i),a=r(282),o=(r(733),r(1163)),u=r(7294),c=r(2132),l=r(8966),d=r.n(l),p=r(5893);function f(e){var n=e.styles,r=((0,u.useRef)(),(0,o.useRouter)()),i=(0,u.useState)(""),l=i[0],f=i[1],h=(0,u.useState)(""),g=h[0],m=h[1],v=(0,u.useState)(""),x=v[0],j=v[1],b=(0,u.useState)(""),k=b[0],y=b[1],N=(0,u.useState)(),A=N[0],C=N[1],O=(0,u.useState)(!1),S=O[0],w=O[1],P={position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0};(0,u.useEffect)((function(){k==A&&(c.Am.success("OTP Verified",P),w(!0))}),[k]);var _=function(){var e=(0,t.Z)(s().mark((function e(){var n,r,t,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g&&l&&x){e.next=2;break}return e.abrupt("return",c.Am.warn("Please Add All Fields",P));case 2:if(d().isEmail(g)){e.next=4;break}return e.abrupt("return",c.Am.error("Wrong Email Address",P));case 4:if(d().isMobilePhone(x)){e.next=6;break}return e.abrupt("return",c.Am.error("Wrong Mobile No.",P));case 6:return e.prev=6,c.Am.info(" Sending OTP",P),n=Math.floor(1e5+9e5*Math.random()),C(n),r={email:g,otp:n},e.next=13,fetch("/api/auth/mail",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 13:return t=e.sent,e.next=16,t.json();case 16:(i=e.sent).message?c.Am.success("OTP Sent",P):c.Am.error(i.error,P),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(6),console.log(e.t0);case 23:case"end":return e.stop()}}),e,null,[[6,20]])})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=(0,t.Z)(s().mark((function e(){var n,t,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S){e.next=2;break}return e.abrupt("return",c.Am.error("OTP not verified yet!",P));case 2:return e.prev=2,c.Am.info("Logging you in",P),n={name:l,email:g,mobile:x},e.next=7,fetch("/api/auth/login",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 7:return t=e.sent,e.next=10,t.json();case 10:(i=e.sent).user?(c.Am.success("Logged in successfully",P),localStorage.setItem("user",JSON.stringify(i.user)),r.back()):c.Am.error(i.error,P),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(){return e.apply(this,arguments)}}();return(0,p.jsx)("div",{className:"modal",style:n,children:(0,p.jsxs)("form",{className:"login-div",children:[(0,p.jsx)(a.Z,{id:"login-back",onClick:function(e){r.back()},children:"X"}),(0,p.jsxs)("div",{className:"login-heading",children:[(0,p.jsx)("h2",{children:"Welcome to Ecommerce"}),(0,p.jsx)("h5",{children:"Login with Email & Mobile"})]}),(0,p.jsxs)("div",{className:"login-input-div",children:[(0,p.jsx)("span",{children:"Name"}),(0,p.jsx)("input",{type:"text",value:l,onChange:function(e){return f(e.target.value)}})]}),(0,p.jsxs)("div",{className:"login-input-div",children:[(0,p.jsx)("span",{children:"Email"}),(0,p.jsx)("input",{type:"text",value:g,onChange:function(e){return m(e.target.value)}})]}),(0,p.jsxs)("div",{className:"login-input-div",children:[(0,p.jsx)("span",{children:"Phone"}),(0,p.jsx)("input",{type:"text",value:x,onChange:function(e){return j(e.target.value)}})]}),(0,p.jsxs)("div",{className:"login-otp-div",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{children:"OTP"}),(0,p.jsx)("input",{type:"number",value:k,onChange:function(e){return y(e.target.value)}})]}),(0,p.jsx)(a.Z,{id:S?"login-otp-verified":"login-otp",onClick:function(){return _()},children:S?"Verified":"Send OTP"})]}),(0,p.jsx)(a.Z,{id:"login-button",onClick:function(){return E()},children:"Login"})]})})}},7156:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return r(1162)}])}},function(e){e.O(0,[611,774,888,179],(function(){return n=7156,e(e.s=n);var n}));var n=e.O();_N_E=n}]);